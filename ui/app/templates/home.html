{% extends "base.html" %}

{% block title %}{{ app_name }} - Exploring Microbial Diversity{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero">
    <div class="hero-content">
        <h1 class="hero-title">
            <span class="accent">Pangenome</span><br>
            Research Observatory
        </h1>
        <p class="hero-description">
            Exploring microbial diversity at scale. Discover research findings, browse database schemas,
            and explore shared knowledge from the KBase BERDL data lakehouse.
        </p>
        <div class="hero-actions">
            <a href="/projects" class="btn btn-primary">Browse Projects</a>
            <a href="/data" class="btn btn-secondary">Explore Data</a>
        </div>
    </div>

    <div class="hero-stats">
        <div class="stat-card">
            <div class="stat-value">{{ total_genomes }}</div>
            <div class="stat-label">genomes</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ total_species }}</div>
            <div class="stat-label">species</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ total_genes }}</div>
            <div class="stat-label">genes</div>
        </div>
    </div>
</section>

<!-- Featured Discoveries -->
<section class="section">
    <div class="section-header">
        <h2 class="section-title">Latest Discoveries</h2>
        <a href="/knowledge/discoveries" class="btn btn-secondary">View All</a>
    </div>

    <div class="grid grid-3">
        {% for discovery in discoveries %}
        <article class="card">
            <div class="card-header">
                <span class="badge badge-project">[{{ discovery.project_tag }}]</span>
            </div>
            <h3 class="card-title">
                <a href="/knowledge/discoveries#{{ discovery.id }}">{{ discovery.title }}</a>
            </h3>
            <div class="card-content">
                <p>{{ discovery.content[:200] }}{% if discovery.content|length > 200 %}...{% endif %}</p>
            </div>
            {% if discovery.date %}
            <div class="card-footer">
                <span class="text-muted text-small">{{ discovery.date.strftime('%B %Y') }}</span>
            </div>
            {% endif %}
        </article>
        {% else %}
        <p class="text-muted">No discoveries yet. Start analyzing!</p>
        {% endfor %}
    </div>
</section>

<!-- Active Projects -->
<section class="section">
    <div class="section-header">
        <h2 class="section-title">Active Projects</h2>
        <a href="/projects" class="btn btn-secondary">View All</a>
    </div>

    <div class="grid grid-3">
        {% for project in projects %}
        <article class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <a href="/projects/{{ project.id }}">{{ project.title }}</a>
                </h3>
                {% if project.status.value == "Completed" %}
                <span class="badge badge-completed">{{ project.status.value }}</span>
                {% elif project.status.value == "In Progress" %}
                <span class="badge badge-in-progress">{{ project.status.value }}</span>
                {% else %}
                <span class="badge badge-proposed">{{ project.status.value }}</span>
                {% endif %}
            </div>
            <div class="card-content">
                <p>{{ project.research_question[:150] }}{% if project.research_question|length > 150 %}...{% endif %}</p>
            </div>
            <div class="card-footer">
                <div class="card-meta">
                    {% if project.notebooks %}
                    <span>{{ project.notebooks|length }} notebooks</span>
                    {% endif %}
                    {% if project.visualizations %}
                    <span>{{ project.visualizations|length }} figures</span>
                    {% endif %}
                </div>
                <a href="/projects/{{ project.id }}" class="btn btn-secondary">View</a>
            </div>
        </article>
        {% else %}
        <p class="text-muted">No projects yet. Start researching!</p>
        {% endfor %}
    </div>
</section>

<!-- Quick Links -->
<section class="section">
    <h2 class="section-title">Quick Links</h2>

    <div class="grid grid-4">
        <a href="/data/schema" class="card">
            <h4>Schema Browser</h4>
            <p class="text-muted text-small">Explore database tables and columns</p>
        </a>
        <a href="/knowledge/pitfalls" class="card">
            <h4>Query Pitfalls</h4>
            <p class="text-muted text-small">Common gotchas and how to avoid them</p>
        </a>
        <a href="/knowledge/ideas" class="card">
            <h4>Research Ideas</h4>
            <p class="text-muted text-small">{{ idea_count }} ideas waiting to be explored</p>
        </a>
        <a href="/about" class="card">
            <h4>About</h4>
            <p class="text-muted text-small">Learn about the project</p>
        </a>
    </div>
</section>
{% endblock %}
